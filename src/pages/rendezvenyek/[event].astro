---
import BaseLayout from '@layouts/BaseLayout.astro';
import Masthead from '@components/Masthead.astro';
import { getCollection, getEntry, render } from 'astro:content';

const { event: eventId } = Astro.params;

export async function getStaticPaths() {
  const events = await getCollection('events');

  return events.map((entry) => ({
    params: { event: entry.id },
    props: { event: entry },
  }));
}

const entry = await getEntry('events', eventId);

if (!entry) {
  return Astro.redirect('/404');
}

const pageTitle = entry.data.title;

const { Content } = await render(entry);
---

<BaseLayout pageTitle={pageTitle}>
  <Masthead pageTitle={pageTitle}>
    <div slot="header-content">
      <p>{entry.data.excerpt}</p>
    </div>
  </Masthead>

  <div class="container mx-auto">
    <Content />
  </div>
</BaseLayout>
