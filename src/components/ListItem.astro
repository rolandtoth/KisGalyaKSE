---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

const featuredImageDefault = '/src/assets/images/featured-image/default.svg';
const { item } = Astro.props;

const featuredImages = import.meta.glob<{ default: ImageMetadata }>(
  '/src/assets/images/featured-image/*.{jpg,png,svg,webp}'
);

const featuredImageFn =
  featuredImages?.[
    '/src/assets/images/featured-image/' + item.data.featuredImage
  ] ?? featuredImages[featuredImageDefault];

const getUrl = (item: any) => {
  let segments = item.filePath
    .replace('src/data/', '')
    .replace('index.md', '')
    .replace('.md', '')
    .split('/')
    .filter((x: string) => x);

  return [segments[0], segments[segments.length - 1]].join('/');
};
---

<div
  class="bg-white flex flex-col gap-4 justify-start prose-default mb-6 px-6 py-4 border-b border-b-gray-300"
>
  <div class="flex items-start gap-6">
    <a href={getUrl(item)} class="w-1/3 rounded-sm">
      <Image
        src={featuredImageFn()}
        alt={item.data.title}
        class="block w-full h-auto !m-0"
      />
    </a>

    <div class="flex flex-col items-start gap-6">
      <h2 class="!m-0 !mt-2 lg:!text-2xl">
        <a href={getUrl(item)} class="!no-underline !text-secondary-700">
          {item.data.title}
        </a>
      </h2>

      <p class="!m-0 !-mt-4 text-xs text-gray-500">
        {new Date(item.data.pubDate).toLocaleDateString('hu-HU')}
      </p>

      <p class="!m-0">{item.data.excerpt}</p>

      <a href={getUrl(item)} class="button">Tov√°bb</a>
    </div>
  </div>
</div>
